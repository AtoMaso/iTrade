
    <div class="container col-md-12">    

              <!-- the breadcrumb and sorting section-->
             <div class="row panel panel-footer" style="height:75px;vertical-align:middle;">

                   <!-- breadcrumb -->
                   <div class="col-md-4 panel panel-heading smalltextbold" style="height:55px;">
                     <div style="margin-top:5px;">
                        <span class="smalltextbold">Displaying <span class="text-info smalltextbold">{{ displayRecords }}</span> of <span class="text-info smalltextbold">{{ config.totalItems }}</span> records </span>                    
                     </div>
                   </div>
                  

                 <!-- filter in all coloumns -->
                   <div class="col-md-4 panel panel-heading" style="height:55px;">                     
                       <div class="col-md-12">                         
                         <input *ngIf="config.filtering" placeholder="Filter in all columns" [ngTableFiltering]="config.filtering" 
                                (tableChanged)="onChangeTable(config)" class="form-control smalltext" style="height:30px;" />
                       </div>                                        
                   </div>


                    <!-- sort -->
                   <div class="col-md-4 panel panel-heading" style="height:55px;">

                         <div class="col-md-6 smalltextbold" style="margin-top:5px;">
                                 <span> Sorted by: <span class="text-info">{{ selectedItem }}</span></span>
                                 <span *ngIf="isAsc" class="glyphicon glyphicon-chevron-down"></span>
                                 <span *ngIf="!isAsc" class="glyphicon glyphicon-chevron-up"></span>
                         </div>       

                         <div class="col-md-6" >
                   
                             <div class="dropdown">
                                 <button class="btn btn-primary dropdown-toggle smalltext" id="menu1" type="button" data-toggle="dropdown" style="height:30px;width:150px;">Sort By
                                   <span class="caret"></span>
                                 </button>
                                 <ul class="dropdown-menu smalltextbold" role="menu" aria-labelledby="menu1">
                                   <li role="presentation"><a role="menuitem" tabindex="-1" (click)="sortTable('name')">Name</a></li>
                                   <li role="presentation" class="divider"></li>
                                   <li role="presentation"><a role="menuitem" tabindex="-1" (click)="sortTable('tradeFor')">Trade For</a></li>
                                   <li role="presentation" class="divider"></li>
                                   <li role="presentation"><a role="menuitem" tabindex="-1" (click)="sortTable('datePublished')">Published</a></li>         
                                   <li role="presentation" class="divider"></li>
                                   <li role="presentation"><a role="menuitem" tabindex="-1" (click)="sortTable('traderFullName')">Trader</a></li>
                                   <li role="presentation" class="divider"></li>
                                   <li role="presentation"><a role="menuitem" tabindex="-1" (click)="sortTable('categoryDescription')">Category</a></li>       
                                   <li role="presentation" class="divider"></li>
                                   <li role="presentation"><a role="menuitem" tabindex="-1" (click)="sortTable('place')">Place</a></li>       
                                   <li role="presentation" class="divider"></li>
                                   <li role="presentation"><a role="menuitem" tabindex="-1" (click)="sortTable('state')">State</a></li>                                   
                                 </ul>
                               </div>

                           </div>            

                     </div>
             
           </div>


            <!-- filter string-->
             <div *ngIf="filters" class="row">            
               <div class="col-md-12 panel panel-title" style="margin-top: -10px;margin-bottom:10px;">                     
                     <span *ngIf="filters != null" class="smalltextbold">Selected filters : <span class="text-info"> {{ filters }}</span></span>
               </div>           
           </div>


           <!-- filters and the table -->
           <div class="row">

                  <!-- filters -->
                 <div class="col-md-2">                                                      
                          <div class="row panel panel-heading wrapper">

                                <nav id="sidebar">

                                    <!-- Sidebar Header -->
                                   <div class="sidebar-header">
                                        <span  data-target="#filters" data-toggle="collapse" class="gliphfil smalltextbold textgray" aria-expanded="false" (click)="ClearAllFilters()">
                                        Filters <span class="glyphicon glyphicon-chevron-up"></span>
                                        </span>
                                  </div>

                                   <!-- Sidebar Links -->
                                   <ul  id="filters" class="collapse in list-unstyled smalltextbold textgray"  style="margin-left:10px;" >
                                                       
                                           <!-- CATEGORIES -->
                                           <li style="margin-top:10px;">
                                                                 
                                                    <a href="#categories" data-toggle="collapse"  class="gliphcat textgray" (click)="ClearCategories()">
                                                          Category <span class="glyphicon glyphicon-chevron-up"></span>
                                                    </a>                                                                                                                                              

                                                    <ul  id="categories" class="collapse in list-unstyled panel-group" style="margin-left:15px;">
                                                        <!-- foreach category here -->
                                                        <li *ngFor="let category of categories" >
                                                                <a   href="#{{ category.categoryDescription }}"  data-toggle="collapse" data-parent="#categories" (click)="CategoryClicked(category)" class="textlightcoral smalltextbold">
                                                                  <span>{{ category.categoryDescription }}</span><span class="caret"></span>
                                                                </a>

                                                                <ul  id="{{ category.categoryDescription }}" class="collapse list-unstyled"  style="margin-left:15px;">
                                                                        <!-- for each subcategories here -->
                                                                        <li *ngFor="let subcategory of category.subcategories">
                                                                                  <a (click)="SubcategoryClicked(subcategory, category)" class="textoker smalltextbold"><span>{{ subcategory.subcategoryDescription }}</span></a>
                                                                        </li>
                                                              </ul>
                                                        </li>
                                                  </ul>                                     
                                           </li>


                                            <!-- PLACES -->
                                           <li style="margin-top:10px;">

                                                 <a href="#places" data-toggle="collapse" aria-expanded="false" class="gliphpl textgray" (click)="ClearPlaces()">
                                                        Place <span class="glyphicon glyphicon-chevron-up"></span>
                                                   </a>

                                                 <ul class="collapse in list-unstyled" id="places" style="margin-left:15px;">
                                                       <!-- foreach state here -->
                                                       <li *ngFor="let state of states">
                                                                <a href="#{{ state.name }}" data-toggle="collapse" aria-expanded="true" (click) ="StateClicked(state)" class="textlightcoral smalltextbold">
                                                                        <span >{{ state.name }}</span><span class="caret"></span>
                                                                </a>

                                                                <ul class="collapse list-unstyled" id="{{ state.name }}" style="margin-left:15px;">
                                                                        <!-- for each place here -->
                                                                       <li *ngFor="let place of state.places">
                                                                               <a (click) ="PlaceClicked(place, state)" class="textoker smalltextbold"><span >{{ place.name }}</span></a>
                                                                        </li>
                                                              </ul>
                                                       </li>
                                                 </ul>                                 
                                            </li>          
                                         
                         
                                          <!-- buttons -->
                                          <li style="margin-top:10px;">
                                            <div>
                                              <button class="btn btn-primary smalltext" (click)="getTradesWithSetFilters()" [disabled]="catIdClicked==0 && subcatIdClicked==0  && stateIdClicked==0 && placeIdClicked == 0 ">Search</button>
                                              <button class="btn btn-primary smalltext" (click)="GoBack()">Clear</button>
                                            </div>
                                          </li>   
                                </ul>
                       
                                </nav>
                                                   
                         </div>       
                   </div>

                 <!-- table -->
                 <div *ngIf="hasTrades" class="col-md-10">

                         <table class="table  table-hover table-responsive">                           
                     
                             <tr *ngFor="let trade of rows  | paginate:config">

                                     <td class="row col-md-12">   
                                                                
                                         <div class="col-md-4 container">                                       
                                           <carousel style="align-content:center;" id="{{ trade.tradeId }}" [tradeId]="trade.tradeId" (onErrorPicked)="ChangeIsRequesting($event)"></carousel>  
                                         </div>


                                         <div class="col-md-4 smalltextbold text-capitalize textgray">                                     
                                           <div class="row"  style="height:30px;">Trading:<a class="text-capitalize textlightcoral" [routerLink]="['/tradedetails']" [queryParams]="{id: trade.tradeId}"> {{ trade.name  }}</a></div>
                                           <div class="row"  style="height:30px;">Trading for: <span class="text-capitalize text-info"> {{ trade.tradeFor  }}</span></div>
                                           <div class="row"  style="height:30px;">Category: <span><span class="text-capitalize text-info"> {{ trade.categoryDescription  }}</span></span></div>        
                                           <div class="row" style="height:30px;">Subcategory: <span><span class="text-capitalize text-info"> {{ trade.subcategoryDescription  }}</span></span></div>       
                                           <div class="row" style="height:30px;">Reference Id:<span class="text-capitalize text-info"> {{ trade.tradeId  }}</span></div>    
                                           <div class="row"  style="height:30px;">Published on:<span class="text-capitalize text-info"> {{ trade.datePublished | date }}</span></div>
                                           <div class="row"  style="height:30px;">Trader: <a class="text-capitalize textlightcoral" [routerLink]="['/traderdetails']" [queryParams]="{id: trade.traderId}"> {{ trade.traderFullName }}</a></div>
                                         </div>


                                         <div class="col-md-4 smalltextbold text-capitalize textgray">
                                           <div class="row"  style="height:120px;">Description:<span  class="text-info"> {{ trade.description  }}</span></div>                                              
                                           <div class="row" style="height:30px;">Status: <span class="text-capitalize text-info"> {{ trade.status  }}</span></div>             
                                           <div class="row"  style="height:30px;">Place:<span  class="text-capitalize text-info"> {{ trade.place  }}</span></div>           
                                           <div class="row" style="height:30px;">State:<span class="text-capitalize text-info"> {{ trade.state  }}</span></div>                                                                                                                                                        
                                       </div>
                  
                                </td>   
                         </tr>
  
                  </table>

             </div>

       </div>



           <!-- Table naviagtion -->
          <div *ngIf="hasSets || hasNavigation" class="row panel panel-footer" style="height:75px;vertical-align:middle;">
             
                <div class="col-md-4 panel panel-heading textsmall"  style="height:55px;vertical-align:middle;">
                  <pagination-controls id="pagination" *ngIf="config.paging" ngDefaultControl
                                       (pageChange)="onPageChange($event)"
                                       maxSize="5"
                                       directionLinks="true"
                                       autoHide="true"
                                       previousLabel="Previous"
                                       nextLabel="Next"
                                       screenReaderPaginationLabel="Pagination"
                                       screenReaderPageLabel="page"
                                       screenReaderCurrentLabel="You're on page"
                                       [(ngModel)]="config.currentPage"
                                       (numPages)="numPages = $event"
                                       [maxSize]="maxSize">
                  </pagination-controls>
                </div>

                <div *ngIf="hasSets">

                  <div class="col-md-2 col-md-offset-1 panel panel-heading" style="height:55px;vertical-align:middle;">
                    <span class="smalltextbold textgray">Set of records: {{setsCounter }} of {{ totalNumberOfSets}}</span>
                  </div>

                  <div class="col-md-3 col-md-offset-2  panel panel-heading" style="height:55px;vertical-align:middle;">
                    <button *ngIf="isNextButton" (click)="nextSetOfRecords()" class="btn btn-success btn-sm smalltextbold">Next Set</button>
                    <button *ngIf="isPrevButton" (click)="previousSetOfRecords()" class="btn btn-success btn-sm smalltextbold">Previous Set</button>
                  </div>

                </div>

          </div>


   </div>

<span *ngIf="hasNoTrades" class="textoker"> The system can not find any trades!</span>

<my-spinner [isRunning]="isRequesting"></my-spinner>
